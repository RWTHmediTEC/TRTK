<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Transformation and Registration Toolkit: D:/Users/haenisch/Programmierung/C++/TRTK/include/TRTK/Optimization.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>D:/Users/haenisch/Programmierung/C++/TRTK/include/TRTK/Optimization.hpp</h1>  </div>
</div>
<div class="contents">
<a href="_optimization_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">    Copyright (C) 2010 - 2014 Christoph Haenisch</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">    Chair of Medical Engineering (mediTEC)</span>
<a name="l00005"></a>00005 <span class="comment">    RWTH Aachen University</span>
<a name="l00006"></a>00006 <span class="comment">    Pauwelsstr. 20</span>
<a name="l00007"></a>00007 <span class="comment">    52074 Aachen</span>
<a name="l00008"></a>00008 <span class="comment">    Germany</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    See license.txt for more information.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">    Version 0.1.0 (2012-06-10)</span>
<a name="l00013"></a>00013 <span class="comment">*/</span>
<a name="l00014"></a>00014 
<a name="l00021"></a>00021 <span class="preprocessor">#ifndef OPTIMIZATION_HPP_4562354833</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#define OPTIMIZATION_HPP_4562354833</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;Eigen/Core&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;Eigen/Dense&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_coordinate_8hpp.html" title="This file contains the Coordinate class and related functions.">Coordinate.hpp</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_definitions_8hpp.html" title="This file contains some commonly used constants of the TRTK library as well as some macro definitions...">Definitions.hpp</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">namespace </span>TRTK
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 
<a name="l00214"></a>00214 <span class="keyword">namespace </span>Optimization
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00239"></a>00239 <span class="keyword">template</span> &lt;<span class="keyword">class</span> ValueType&gt;
<a name="l00240"></a>00240 <span class="keyword">struct </span>Options
<a name="l00241"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ae48021f391c07a769c7ba90691e4580d">00241</a> {
<a name="l00242"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#aceb2e8e53199dbd3f7644401823446e9">00242</a>     <span class="keyword">typedef</span> ValueType value_type;
<a name="l00243"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9877ac6eea421ac0af513c45ebb37a65">00243</a> 
<a name="l00244"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9fdcdbf80d52f3d4b579ec43813fe0c5">00244</a>     value_type   <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ae48021f391c07a769c7ba90691e4580d" title="This value is used by some algorithms as an abortion criterion.">error_tolerance</a>;               
<a name="l00245"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a8117ceed2c47ce098f16cd9a8bfdd68b">00245</a>     value_type   <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#aceb2e8e53199dbd3f7644401823446e9" title="Damping parameter used by the Levenberg-Marquardt algorithm.">lambda</a>;                        
<a name="l00246"></a>00246     <span class="keywordtype">unsigned</span>     <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9877ac6eea421ac0af513c45ebb37a65" title="Maximum number of iterations performed during an iteration.">max_number_iterations</a>;         
<a name="l00247"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972">00247</a>     value_type   <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9fdcdbf80d52f3d4b579ec43813fe0c5" title="Damping parameter used by the Levenberg-Marquardt algorithm.">nu</a>;                            
<a name="l00248"></a>00248     value_type   <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a8117ceed2c47ce098f16cd9a8bfdd68b" title="Spacing used while computing a finit difference (approximation of the derivative).">spacing</a>;                       
<a name="l00249"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972a1a2fc84296a310d805b5170bd3a8bfc6">00249</a> 
<a name="l00250"></a><a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972a2a0971c1c0f4ee72bc7c40f2d938a44a">00250</a>     <span class="keyword">enum</span> <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972">Algorithm</a>
<a name="l00251"></a>00251     {
<a name="l00252"></a>00252         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972a1a2fc84296a310d805b5170bd3a8bfc6" title="Levenberg-Marquardt Algorithm.">LEVENBERG_MARQUARDT</a>,                    
<a name="l00253"></a>00253         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972a2a0971c1c0f4ee72bc7c40f2d938a44a" title="Newton-Raphson Method.">NEWTON_RAPHSON</a>                          
<a name="l00254"></a>00254     } <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a0f6aa90e01f12c7514a4ef853687ad23" title="Algorithm used for the computations.">algorithm</a>;                                
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html" title="Structure used by several functions to control their operation.">Options</a>() :
<a name="l00257"></a>00257         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ae48021f391c07a769c7ba90691e4580d" title="This value is used by some algorithms as an abortion criterion.">error_tolerance</a>(1e-15),
<a name="l00258"></a>00258         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#aceb2e8e53199dbd3f7644401823446e9" title="Damping parameter used by the Levenberg-Marquardt algorithm.">lambda</a>(1e-2),
<a name="l00259"></a>00259         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9877ac6eea421ac0af513c45ebb37a65" title="Maximum number of iterations performed during an iteration.">max_number_iterations</a>(25),
<a name="l00260"></a>00260         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a9fdcdbf80d52f3d4b579ec43813fe0c5" title="Damping parameter used by the Levenberg-Marquardt algorithm.">nu</a>(10),
<a name="l00261"></a>00261         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a8117ceed2c47ce098f16cd9a8bfdd68b" title="Spacing used while computing a finit difference (approximation of the derivative).">spacing</a>(1e-6),
<a name="l00262"></a>00262         <a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#a0f6aa90e01f12c7514a4ef853687ad23" title="Algorithm used for the computations.">algorithm</a>(<a class="code" href="struct_t_r_t_k_1_1_optimization_1_1_options.html#ac362edb19bd659a543f47c6b9c843972a1a2fc84296a310d805b5170bd3a8bfc6" title="Levenberg-Marquardt Algorithm.">LEVENBERG_MARQUARDT</a>)
<a name="l00263"></a>00263     {
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 };
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 
<a name="l00273"></a>00273 <span class="keyword">template</span> &lt;<span class="keyword">class</span> ValueType&gt;
<a name="l00274"></a>00274 <span class="keyword">struct </span>Result
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276     <span class="keyword">typedef</span> Eigen::Matrix&lt;ValueType, Eigen::Dynamic, Eigen::Dynamic&gt; matrix_type;
<a name="l00277"></a>00277     <span class="keyword">typedef</span> <a class="code" href="class_t_r_t_k_1_1_coordinate.html">TRTK::Coordinate&lt;ValueType&gt;</a> Coordinate;
<a name="l00278"></a>00278     <span class="keyword">typedef</span> ValueType value_type;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     value_type   error;
<a name="l00281"></a>00281     matrix_type  jacobian;
<a name="l00282"></a>00282     <span class="keywordtype">unsigned</span>     number_of_iterations;
<a name="l00283"></a>00283     Coordinate   root;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     Result() : error(0), number_of_iterations(0)
<a name="l00286"></a>00286     {
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288 };
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 
<a name="l00368"></a>00368 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00369"></a>00369 <span class="keyword">class </span>Gradient
<a name="l00370"></a>00370 {
<a name="l00371"></a>00371 <span class="keyword">public</span>:
<a name="l00372"></a>00372     <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#a4d0c5e105c70c2a7987681841f971c84" title="Constructs a gradient function of the given function.">Gradient</a>(Function &amp; function, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;());
<a name="l00373"></a>00373     <span class="keyword">virtual</span> <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#a4476642b505393ccf0480370cf537164" title="Destructs the instance of Gradient.">~Gradient</a>();
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     Coordinate&lt;ValueType&gt; <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#ab4714c5ab18666caf43cb4cf2c00f453" title="Returns the gradient.">operator()</a>(<span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; value);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="keyword">private</span>:
<a name="l00378"></a>00378     Function &amp; function;
<a name="l00379"></a>00379     Options&lt;ValueType&gt; options;
<a name="l00380"></a>00380 };
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 
<a name="l00385"></a>00385 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00386"></a>00386 <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#a4d0c5e105c70c2a7987681841f971c84" title="Constructs a gradient function of the given function.">Gradient&lt;Function, ValueType&gt;::Gradient</a>(Function &amp; function, Options&lt;ValueType&gt; options) :
<a name="l00387"></a>00387     function(function),
<a name="l00388"></a>00388     options(options)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 
<a name="l00395"></a>00395 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00396"></a>00396 <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#a4476642b505393ccf0480370cf537164" title="Destructs the instance of Gradient.">Gradient&lt;Function, ValueType&gt;::~Gradient</a>()
<a name="l00397"></a>00397 {
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 
<a name="l00403"></a>00403 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00404"></a>00404 Coordinate&lt;ValueType&gt; <a class="code" href="class_t_r_t_k_1_1_optimization_1_1_gradient.html#ab4714c5ab18666caf43cb4cf2c00f453" title="Returns the gradient.">Gradient&lt;Function, ValueType&gt;::operator()</a>(<span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; value)
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406     <span class="comment">// function : R^n --&gt; R</span>
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n = value.size();
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     Coordinate&lt;ValueType&gt; gradient;
<a name="l00411"></a>00411     gradient.resize(n);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="preprocessor">    #ifdef TRTK_PARALLELIZE_GRADIENT</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span><span class="preprocessor">    #pragma omp parallel for</span>
<a name="l00415"></a>00415 <span class="preprocessor"></span><span class="preprocessor">    #endif // TRTK_PARALLELIZE_GRADIENT</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00417"></a>00417     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(n); ++i)
<a name="l00418"></a>00418     {
<a name="l00419"></a>00419         <span class="comment">// Use the five-point stencil method to compute the derivatives.</span>
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keyword">const</span> ValueType spacing = options.spacing;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423         Coordinate&lt;ValueType&gt; h;
<a name="l00424"></a>00424         h.resize(n);
<a name="l00425"></a>00425         h[i] = spacing; <span class="comment">// = (0, ..., 0, spacing, 0, ..., 0)</span>
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         ValueType a = function(value - 2.0 * h);
<a name="l00428"></a>00428         ValueType b = function(value -       h);
<a name="l00429"></a>00429         ValueType c = function(value +       h);
<a name="l00430"></a>00430         ValueType d = function(value + 2.0 * h);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432         gradient[i] = (a - 8.0 * b + 8.0 * c - d) / (12.0 * spacing);
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     <span class="keywordflow">return</span> gradient;
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 
<a name="l00505"></a>00505 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00506"></a>00506 Eigen::Matrix&lt;ValueType, Eigen::Dynamic, Eigen::Dynamic&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>(Function f, <span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; x, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;())
<a name="l00507"></a>00507 {
<a name="l00508"></a>00508     <span class="keyword">using namespace </span>Eigen;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="keyword">typedef</span> <a class="code" href="class_t_r_t_k_1_1_coordinate.html">TRTK::Coordinate&lt;ValueType&gt;</a> Coordinate;
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <span class="comment">// function : R^n --&gt; R^m</span>
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n = x.<a class="code" href="class_t_r_t_k_1_1_coordinate.html#af41309082a015b059fe4f50e2d8b37b5">size</a>();
<a name="l00515"></a>00515     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> m = f(x).size();
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     Matrix&lt;ValueType, Dynamic, Dynamic&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>(m, n);
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 <span class="preprocessor">    #ifdef TRTK_PARALLELIZE_JACOBIAN</span>
<a name="l00520"></a>00520 <span class="preprocessor"></span><span class="preprocessor">    #pragma omp parallel for</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span><span class="preprocessor">    #endif // TRTK_PARALLELIZE_JACOBIAN</span>
<a name="l00522"></a>00522 <span class="preprocessor"></span>
<a name="l00523"></a>00523     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; int(n); ++col)
<a name="l00524"></a>00524     {
<a name="l00525"></a>00525         <span class="comment">// Use the five-point stencil method to compute the derivatives.</span>
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         <span class="keyword">const</span> ValueType spacing = options.spacing;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529         Coordinate h;
<a name="l00530"></a>00530         h.resize(n);
<a name="l00531"></a>00531         h[col] = spacing; <span class="comment">// = (0, ..., 0, spacing, 0, ..., 0)</span>
<a name="l00532"></a>00532 
<a name="l00533"></a>00533         Coordinate a = f(x - 2.0 * h);
<a name="l00534"></a>00534         Coordinate b = f(x -       h);
<a name="l00535"></a>00535         Coordinate c = f(x +       h);
<a name="l00536"></a>00536         Coordinate d = f(x + 2.0 * h);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         Coordinate derivatives_in_col = (a - 8.0 * b + 8.0 * c - d) / (12.0 * spacing);
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> row = 0; row &lt; m; ++row)
<a name="l00541"></a>00541         {
<a name="l00542"></a>00542             <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>(row, col) = derivatives_in_col[row];
<a name="l00543"></a>00543         }
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <span class="keywordflow">return</span> <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 
<a name="l00634"></a>00634 <span class="keyword">template</span> &lt;<span class="keyword">class</span> ValueType, <span class="keyword">class</span> Function&gt;
<a name="l00635"></a>00635 Gradient&lt;Function, ValueType&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a9b63d6a96bdf9222505dd8a894ba1eef" title="Returns an instance of Gradient. The template argument types are automatically deduced.">makeGradient</a>(Function &amp; function, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;())
<a name="l00636"></a>00636 {
<a name="l00637"></a>00637     <span class="keywordflow">return</span> Gradient&lt;Function, ValueType&gt;(function, options);
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 
<a name="l00714"></a>00714 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00715"></a>00715 Result&lt;ValueType&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a5444c0119ca86147391989b4a20ea8a6" title="This function solves for the root (zero) of a given function.">solve</a>(Function function, <span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; start_value, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;())
<a name="l00716"></a>00716 {
<a name="l00717"></a>00717     <span class="keywordflow">switch</span>(options.algorithm)
<a name="l00718"></a>00718     {
<a name="l00719"></a>00719         <span class="keywordflow">case</span> Options&lt;ValueType&gt;::LEVENBERG_MARQUARDT:
<a name="l00720"></a>00720             <span class="keywordflow">return</span> <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a2740acef116b835b6c18d69acf41f4ed" title="This function solves for the root (zero) of a given function.">solveLevenbergMarquardt</a>(function, start_value, options);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722         <span class="keywordflow">case</span> Options&lt;ValueType&gt;::NEWTON_RAPHSON:
<a name="l00723"></a>00723             <span class="keywordflow">return</span> <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a2740acef116b835b6c18d69acf41f4ed" title="This function solves for the root (zero) of a given function.">solveLevenbergMarquardt</a>(function, start_value, options);
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <span class="keywordflow">default</span>:
<a name="l00726"></a>00726             <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;TRTK::Optimization::solve(): Unknown solver algorithm.&quot;</span>);
<a name="l00727"></a>00727     }
<a name="l00728"></a>00728 }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 
<a name="l00769"></a>00769 <span class="keyword">template</span>&lt;<span class="keyword">class</span> UnaryFunction, <span class="keyword">class</span> ValueType&gt;
<a name="l00770"></a>00770 ValueType <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a270580dffe03da11a7c745c9037ea8a9" title="This function solves for the root (zero) of a given function.">solve1D</a>(UnaryFunction f, ValueType start_value, <span class="keywordtype">unsigned</span> max_number_iterations = 25)
<a name="l00771"></a>00771 {
<a name="l00772"></a>00772     <span class="keyword">const</span> ValueType epsilon = 0.000001;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     ValueType x = start_value;
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; max_number_iterations; ++i)
<a name="l00777"></a>00777     {
<a name="l00778"></a>00778         ValueType a = f(x - 2 * epsilon);
<a name="l00779"></a>00779         ValueType b = f(x -     epsilon);
<a name="l00780"></a>00780         ValueType c = f(x +     epsilon);
<a name="l00781"></a>00781         ValueType d = f(x + 2 * epsilon);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783         ValueType f_prime = (a - 8 * b + 8 * c - d) / (12 * epsilon); <span class="comment">// five-point stencil method</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785         <span class="keywordflow">if</span> (f_prime == 0) <span class="keywordflow">break</span>; <span class="comment">// Avoid a division by zero.</span>
<a name="l00786"></a>00786 
<a name="l00787"></a>00787         x = x - f(x) / f_prime;
<a name="l00788"></a>00788     }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790     <span class="keywordflow">return</span> x;
<a name="l00791"></a>00791 }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 
<a name="l00896"></a>00896 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l00897"></a>00897 Result&lt;ValueType&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a2740acef116b835b6c18d69acf41f4ed" title="This function solves for the root (zero) of a given function.">solveLevenbergMarquardt</a>(Function function, <span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; start_value, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;())
<a name="l00898"></a>00898 {
<a name="l00899"></a>00899     <span class="comment">// The algorithm is implemented as described in the original article</span>
<a name="l00900"></a>00900     <span class="comment">// of Marquardt. However, instead of scaling the matrix A and the vector</span>
<a name="l00901"></a>00901     <span class="comment">// g we add lambda * diag(A) to A rather than lambda * I since this is</span>
<a name="l00902"></a>00902     <span class="comment">// equivalent but more efficient.</span>
<a name="l00903"></a>00903 
<a name="l00904"></a>00904     <span class="keyword">using</span> std::numeric_limits;
<a name="l00905"></a>00905     <span class="keyword">using</span> <a class="code" href="namespace_t_r_t_k.html#ab6a8c5f73ab8b7638ca1011e6f2c89aa" title="Computes the square root of each element.">std::sqrt</a>;
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <span class="keyword">using namespace </span>Eigen;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909     <span class="keyword">typedef</span> <a class="code" href="class_t_r_t_k_1_1_coordinate.html">TRTK::Coordinate&lt;ValueType&gt;</a> Coordinate;
<a name="l00910"></a>00910     <span class="keyword">typedef</span> Eigen::Matrix&lt;ValueType, Dynamic, 1&gt; Vector;
<a name="l00911"></a>00911     <span class="keyword">typedef</span> Eigen::Matrix&lt;ValueType, Dynamic, Dynamic&gt; Matrix;
<a name="l00912"></a>00912 
<a name="l00913"></a>00913     <span class="keywordtype">unsigned</span> iteration = 0;
<a name="l00914"></a>00914     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> m = function(start_value).<a class="code" href="class_t_r_t_k_1_1_coordinate.html#af41309082a015b059fe4f50e2d8b37b5">size</a>();    <span class="comment">// function : R^n --&gt; R^m</span>
<a name="l00915"></a>00915     ValueType error = 0;
<a name="l00916"></a>00916     ValueType lambda = options.lambda;                  <span class="comment">// damping parameter</span>
<a name="l00917"></a>00917     ValueType nu = options.nu;                          <span class="comment">// damping parameter</span>
<a name="l00918"></a>00918     ValueType Phi = numeric_limits&lt;ValueType&gt;::max();
<a name="l00919"></a>00919     Coordinate x = start_value;
<a name="l00920"></a>00920     Matrix <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l00921"></a>00921 
<a name="l00922"></a>00922     assert(lambda &gt; 0);
<a name="l00923"></a>00923     assert(nu &gt; 1);
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="keywordflow">for</span> (iteration = 0; iteration &lt; options.max_number_iterations; ++iteration)
<a name="l00926"></a>00926     {
<a name="l00927"></a>00927         <span class="comment">// Compute Phi(lambda) and Phi(lambda/nu).</span>
<a name="l00928"></a>00928 
<a name="l00929"></a>00929         <span class="comment">// Now, compute (A + lambda * diag(A)) * delta = g where A = Jacobian(f)^T *</span>
<a name="l00930"></a>00930         <span class="comment">// Jacobian(f) and g = Jacobian(f)^T * f. Split the computation due to</span>
<a name="l00931"></a>00931         <span class="comment">// stability reasons; this also leads to a speed up since no inverse must</span>
<a name="l00932"></a>00932         <span class="comment">// be computed.</span>
<a name="l00933"></a>00933 
<a name="l00934"></a>00934         Vector x1 = x.toArray(); <span class="comment">// --&gt; Phi(lambda / nu)</span>
<a name="l00935"></a>00935         Vector x2 = x.toArray(); <span class="comment">// --&gt; Phi(lambda)</span>
<a name="l00936"></a>00936         Vector f  = function(x).toArray();
<a name="l00937"></a>00937 
<a name="l00938"></a>00938         <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a> = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">Optimization::jacobian</a>(function, x, options);
<a name="l00939"></a>00939 
<a name="l00940"></a>00940         <span class="keywordflow">if</span> (<a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>.norm() == 0)
<a name="l00941"></a>00941         {
<a name="l00942"></a>00942             error = function(x).norm() / <a class="code" href="namespace_t_r_t_k.html#ab6a8c5f73ab8b7638ca1011e6f2c89aa" title="Computes the square root of each element.">sqrt</a>(ValueType(m)); <span class="comment">// RMSE</span>
<a name="l00943"></a>00943             <span class="keywordflow">break</span>;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946         Matrix jj = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>.transpose() * <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l00947"></a>00947         Matrix diagonal = Matrix(jj.diagonal().asDiagonal());
<a name="l00948"></a>00948         Matrix left_term1 = jj + lambda / nu * diagonal;
<a name="l00949"></a>00949         Matrix left_term2 = jj + lambda * diagonal;
<a name="l00950"></a>00950         Vector right_term = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>.transpose() * -f;
<a name="l00951"></a>00951 
<a name="l00952"></a>00952         <span class="comment">// Same as &quot;x1 = x1 - (jj + lambda / nu * diagonal).inverse() * jacobian.transpose() * f;&quot;</span>
<a name="l00953"></a>00953         <span class="comment">// but faster and more stable:</span>
<a name="l00954"></a>00954 
<a name="l00955"></a>00955         Vector delta = left_term1.fullPivLu().solve(right_term);
<a name="l00956"></a>00956         x1 = delta + x1;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958         delta = left_term2.fullPivLu().solve(right_term);
<a name="l00959"></a>00959         x2 = delta + x2;
<a name="l00960"></a>00960 
<a name="l00961"></a>00961         ValueType Phi1 = function(Coordinate(x1)).squaredNorm();
<a name="l00962"></a>00962         ValueType Phi2 = function(Coordinate(x2)).squaredNorm();
<a name="l00963"></a>00963 
<a name="l00964"></a>00964         <span class="comment">// Case-by-case analysis</span>
<a name="l00965"></a>00965 
<a name="l00966"></a>00966         <span class="keywordflow">if</span> (Phi1 &lt;= Phi)
<a name="l00967"></a>00967         {
<a name="l00968"></a>00968             <span class="comment">// case i. in the original article</span>
<a name="l00969"></a>00969 
<a name="l00970"></a>00970             lambda = lambda / nu;
<a name="l00971"></a>00971             Phi = Phi1;
<a name="l00972"></a>00972             x = Coordinate(x1);
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974         <span class="keywordflow">else</span>
<a name="l00975"></a>00975         {
<a name="l00976"></a>00976             <span class="keywordflow">if</span> (Phi2 &lt;= Phi)
<a name="l00977"></a>00977             {
<a name="l00978"></a>00978                 <span class="comment">// case ii. in the original article</span>
<a name="l00979"></a>00979 
<a name="l00980"></a>00980                 lambda = lambda;
<a name="l00981"></a>00981                 Phi = Phi2;
<a name="l00982"></a>00982                 x = Coordinate(x2);
<a name="l00983"></a>00983             }
<a name="l00984"></a>00984             <span class="keywordflow">else</span>
<a name="l00985"></a>00985             {
<a name="l00986"></a>00986                 <span class="comment">// case iii. in the original article</span>
<a name="l00987"></a>00987 
<a name="l00988"></a>00988                 Vector x3 = x.toArray();
<a name="l00989"></a>00989 
<a name="l00990"></a>00990                 ValueType lambda3 = lambda;
<a name="l00991"></a>00991                 ValueType Phi3 = Phi;
<a name="l00992"></a>00992 
<a name="l00993"></a>00993                 <span class="keywordtype">unsigned</span> w = 0;
<a name="l00994"></a>00994                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> MAX_POWER = 100; <span class="comment">// this bound is arbitrarily chosen...</span>
<a name="l00995"></a>00995 
<a name="l00996"></a>00996                 <span class="keywordflow">do</span>
<a name="l00997"></a>00997                 {
<a name="l00998"></a>00998                     lambda3 *= nu; <span class="comment">// increase lambda by successive multiplication</span>
<a name="l00999"></a>00999 
<a name="l01000"></a>01000                     Matrix left_term = jj + lambda3 * diagonal;
<a name="l01001"></a>01001                     x3 += left_term.fullPivLu().solve(right_term);
<a name="l01002"></a>01002 
<a name="l01003"></a>01003                     Phi3 = function(Coordinate(x3)).squaredNorm();
<a name="l01004"></a>01004                 }
<a name="l01005"></a>01005                 <span class="keywordflow">while</span> (!(Phi3 &lt;= Phi || w++ &gt;= MAX_POWER));
<a name="l01006"></a>01006 
<a name="l01007"></a>01007                 <span class="keywordflow">if</span> (w &gt; MAX_POWER)
<a name="l01008"></a>01008                 {
<a name="l01009"></a>01009                     <span class="comment">// increasing lambda does not seem to work, hence do nothing</span>
<a name="l01010"></a>01010                     <span class="comment">// and keep the old value (Phi3 might now be even worse...)</span>
<a name="l01011"></a>01011                 }
<a name="l01012"></a>01012                 <span class="keywordflow">else</span>
<a name="l01013"></a>01013                 {
<a name="l01014"></a>01014                     lambda = lambda3;
<a name="l01015"></a>01015                     Phi = Phi3;
<a name="l01016"></a>01016                     x = Coordinate(x3);
<a name="l01017"></a>01017                 }
<a name="l01018"></a>01018             }
<a name="l01019"></a>01019         }
<a name="l01020"></a>01020 
<a name="l01021"></a>01021         <span class="comment">// Converged or small enough RMSE?</span>
<a name="l01022"></a>01022 
<a name="l01023"></a>01023         Coordinate return_value = function(x);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025         <span class="comment">// Check whether the error (RMSE) is less than the given error</span>
<a name="l01026"></a>01026         <span class="comment">// tolerance. Should the situation arise, stop the iteration.</span>
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         error = return_value.norm() / <a class="code" href="namespace_t_r_t_k.html#ab6a8c5f73ab8b7638ca1011e6f2c89aa" title="Computes the square root of each element.">sqrt</a>(ValueType(m));
<a name="l01029"></a>01029 
<a name="l01030"></a>01030         <span class="keywordflow">if</span> (error &lt; options.error_tolerance) <span class="keywordflow">break</span>;
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032 
<a name="l01033"></a>01033     Result&lt;ValueType&gt; result;
<a name="l01034"></a>01034 
<a name="l01035"></a>01035     result.error = error;
<a name="l01036"></a>01036     result.jacobian = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l01037"></a>01037     result.number_of_iterations = iteration + 1;
<a name="l01038"></a>01038     result.root = x;
<a name="l01039"></a>01039 
<a name="l01040"></a>01040     <span class="keywordflow">return</span> result;
<a name="l01041"></a>01041 }
<a name="l01042"></a>01042 
<a name="l01043"></a>01043 
<a name="l01120"></a>01120 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Function, <span class="keyword">class</span> ValueType&gt;
<a name="l01121"></a>01121 Result&lt;ValueType&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a6d832dd2eede65349208f27bd12f1115" title="This function solves for the root (zero) of a given function.">solveNewtonRaphsonMethod</a>(Function function, <span class="keyword">const</span> Coordinate&lt;ValueType&gt; &amp; start_value, Options&lt;ValueType&gt; options = Options&lt;ValueType&gt;())
<a name="l01122"></a>01122 {
<a name="l01123"></a>01123     <span class="keyword">using namespace </span>Eigen;
<a name="l01124"></a>01124 
<a name="l01125"></a>01125     <span class="keyword">using</span> <a class="code" href="namespace_t_r_t_k.html#ab6a8c5f73ab8b7638ca1011e6f2c89aa" title="Computes the square root of each element.">std::sqrt</a>;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127     <span class="keyword">typedef</span> <a class="code" href="class_t_r_t_k_1_1_coordinate.html">TRTK::Coordinate&lt;ValueType&gt;</a> Coordinate;
<a name="l01128"></a>01128 
<a name="l01129"></a>01129     <span class="comment">// function : R^n --&gt; R^m</span>
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <span class="comment">// const unsigned n = start_value.size();</span>
<a name="l01132"></a>01132     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> m = function(start_value).<a class="code" href="class_t_r_t_k_1_1_coordinate.html#af41309082a015b059fe4f50e2d8b37b5">size</a>();
<a name="l01133"></a>01133 
<a name="l01134"></a>01134     Coordinate x = start_value;
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     Matrix&lt;ValueType, Dynamic, Dynamic&gt; <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138     ValueType error = 0;
<a name="l01139"></a>01139 
<a name="l01140"></a>01140     <span class="keywordtype">unsigned</span> iteration = 0;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     <span class="keywordflow">for</span> (iteration = 0; iteration &lt; options.max_number_iterations; ++iteration)
<a name="l01143"></a>01143     {
<a name="l01144"></a>01144         Coordinate return_value = function(x);
<a name="l01145"></a>01145 
<a name="l01146"></a>01146         <span class="comment">// Check whether the error (RMS) is less than the given error</span>
<a name="l01147"></a>01147         <span class="comment">// tolerance. Should the situation arise, stop the iteration.</span>
<a name="l01148"></a>01148 
<a name="l01149"></a>01149         error = return_value.norm() / <a class="code" href="namespace_t_r_t_k.html#ab6a8c5f73ab8b7638ca1011e6f2c89aa" title="Computes the square root of each element.">sqrt</a>(ValueType(m));
<a name="l01150"></a>01150 
<a name="l01151"></a>01151         <span class="keywordflow">if</span> (error &lt; options.error_tolerance) <span class="keywordflow">break</span>;
<a name="l01152"></a>01152 
<a name="l01153"></a>01153         <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a> = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">Optimization::jacobian</a>(function, x, options);
<a name="l01154"></a>01154 
<a name="l01155"></a>01155         <span class="keywordflow">if</span> (<a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>.norm() == 0) <span class="keywordflow">break</span>;
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         Matrix&lt;ValueType, Dynamic, 1&gt; x_ = x.toArray();
<a name="l01158"></a>01158         Matrix&lt;ValueType, Dynamic, 1&gt; f_ = function(x).toArray();
<a name="l01159"></a>01159 
<a name="l01160"></a>01160         <span class="comment">// Same as &quot;x_ = x_ - Jacobian.inverse() * f_;&quot; but faster and more stable:</span>
<a name="l01161"></a>01161 
<a name="l01162"></a>01162         Matrix&lt;ValueType, Dynamic, 1&gt; delta = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>.fullPivLu().solve(-f_);
<a name="l01163"></a>01163         x_ = delta + x_;
<a name="l01164"></a>01164 
<a name="l01165"></a>01165         x = Coordinate(x_);
<a name="l01166"></a>01166     }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168     Result&lt;ValueType&gt; result;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170     result.error = error;
<a name="l01171"></a>01171     result.jacobian = <a class="code" href="namespace_t_r_t_k_1_1_optimization.html#a57d46d5b206adc1c3310577f1836524f" title="Computes the Jacobian of f at x.">jacobian</a>;
<a name="l01172"></a>01172     result.number_of_iterations = iteration;
<a name="l01173"></a>01173     result.root = x;
<a name="l01174"></a>01174 
<a name="l01175"></a>01175     <span class="keywordflow">return</span> result;
<a name="l01176"></a>01176 }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178 
<a name="l01179"></a>01179 } <span class="comment">// namespace Optimization</span>
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 } <span class="comment">// namespace TRTK</span>
<a name="l01183"></a>01183 
<a name="l01184"></a>01184 
<a name="l01185"></a>01185 <span class="preprocessor">#endif // OPTIMIZATION_HPP_4562354833</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/>
    <address class="footer">
        <small>
            Copyright 2010 - 2016 by Christoph HÃ¤nisch,
            Chair of Medical Engineering (mediTEC),
            RWTH Aachen University <p>
            Documentation generated by <a href="http://www.doxygen.org/index.html"> Doxygen </a>
        </small>
    </address>

</body>
</html>
